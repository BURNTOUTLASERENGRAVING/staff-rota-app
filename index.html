<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Staff Rota & Task Checklist</title>
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>

<div id="landing-page">
    <div class="landing-card">
        <h1>Welcome to RotaApp</h1>
        <p id="landing-page-message">Loading staff profiles...</p>
        <div id="staff-icons-container">
            <!-- Staff icons will be generated by JS -->
        </div>
    </div>
</div>

<div id="app-container" class="hidden">
    <aside id="sidebar-nav">
        <div class="sidebar-header">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="logo-icon"><path fill-rule="evenodd" d="M12.516 2.17a.75.75 0 00-1.032 0 11.209 11.209 0 01-7.877 3.08.75.75 0 00-.722.515A12.74 12.74 0 002.25 9.75c0 5.942 4.064 10.933 9.563 12.348a.749.749 0 00.374 0c5.499-1.415 9.563-6.406 9.563-12.348 0-1.39-.223-2.73-.635-3.985a.75.75 0 00-.722-.516l-.143.001c-2.996 0-5.717-1.17-7.734-3.08zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zM12 15a.75.75 0 01.75.75v.008a.75.75 0 01-1.5 0V15.75A.75.75 0 0112 15z" clip-rule="evenodd" /></svg>
            <span class="logo-text">RotaApp</span>
        </div>
        <nav>
            <button id="nav-home" class="nav-btn active"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h7.5" /></svg><span>Home</span></button>
            <button id="nav-calendar" class="nav-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0h18" /></svg><span>Full Rota</span></button>
            <button id="nav-my-availability" class="nav-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" /></svg><span>My Availability</span></button>
            <button id="nav-holiday-request" class="nav-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.72 9.72 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" /></svg><span>Holiday Requests</span></button>
            <button id="nav-shift-swap" class="nav-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M7.5 21L3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5" /></svg><span>Shift Swaps</span></button>
            <button id="nav-dashboard" class="nav-btn hidden"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6a7.5 7.5 0 100 15 7.5 7.5 0 000-15zM21 21l-5.197-5.197" /></svg><span>Dashboard</span></button>
            <button id="nav-admin" class="nav-btn hidden"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m-7.5-2.228a4.5 4.5 0 00-1.897 1.897M18 18.72a9.094 9.094 0 00-7.8-3.597m7.8 3.597c.433-.142.85-.316 1.22-.519m-9.02 2.285c-.88.18-1.787.27-2.72.27a8.966 8.966 0 01-5.334-1.609m12.358-6.31c.39.202.75.432 1.08.687m-1.08-.687c-.366.113-.746.199-1.144.27M12 6c3.314 0 6 2.686 6 6s-2.686 6-6 6-6-2.686-6-6 2.686-6 6-6z" /></svg><span>Admin Panel</span></button>
        </nav>
        <div class="sidebar-footer">
          <div id="user-info-short" class="hidden"></div>
          <button id="nav-my-settings" class="nav-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12a7.5 7.5 0 0015 0m-15 0a7.5 7.5 0 1115 0m-15 0H3m18 0h-1.5m-15.06-7.03l-1.06-1.06M20.62 3.38l-1.06 1.06m-15.06 14.122l-1.06 1.06M20.62 20.62l-1.06-1.06M12 6.75v-1.5m0 15v-1.5" /></svg><span>My Settings</span></button>
          <div id="user-info-full"></div>
          <button id="sign-out-btn" class="nav-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75" /></svg><span>Sign Out</span></button>
        </div>
    </aside>

    <main id="main-content">
        <!-- PIN Entry Screen -->
        <section id="pin-entry-view" class="hidden auth-view">
            <div class="auth-form-container">
                <h2>Enter PIN for <strong id="pin-login-user-display">User</strong></h2>
                <form id="pin-login-form">
                    <input type="password" id="pin-input" inputmode="numeric" pattern="[0-9]*" maxlength="4" required autocomplete="off">
                    <div class="pin-actions">
                        <button type="submit" class="btn btn-primary">Login</button>
                        <button type="button" id="pin-cancel-btn" class="btn btn-secondary">Cancel</button>
                    </div>
                </form>
            </div>
        </section>

        <!-- Home View -->
        <section id="home-view" class="hidden">
            <div class="page-header">
              <h2>Home Dashboard</h2>
              <div id="clock-status-banner">
                <span>You are currently not clocked in.</span>
                <button class="btn btn-primary btn-sm">Clock In</button>
              </div>
            </div>
            <div class="home-grid">
              <div class="card">
                <h3>Who's Working Today</h3>
                <ul class="simple-list" id="whos-working-today"></ul>
              </div>
              <div class="card">
                <h3>Message Board</h3>
                <ul class="simple-list" id="message-board-list"></ul>
              </div>
              <div class="card">
                  <h3>Upcoming Shifts</h3>
                  <ul class="simple-list" id="your-upcoming-shifts"></ul>
              </div>
            </div>
        </section>
        
        <!-- My Availability View -->
        <section id="my-availability-view" class="hidden">
            <div class="card">
              <div class="page-header with-actions">
                <div>
                    <h2>My Availability</h2>
                    <p id="availability-week-display" class="subtitle"></p>
                </div>
                <div class="header-actions">
                    <button id="availability-prev-week" class="btn btn-secondary">‹ Prev Week</button>
                    <button id="availability-next-week" class="btn btn-primary">Next Week ›</button>
                </div>
              </div>
              <div id="availability-grid"></div>
            </div>
        </section>

        <!-- Calendar / Full Rota View -->
        <section id="calendar-view" class="hidden">
          <div class="card">
            <div class="page-header with-actions">
                <div>
                    <h2>Monthly Rota</h2>
                    <p id="calendar-month-year" class="subtitle">Month Year</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary" id="calendar-prev-month">◄</button>
                    <button class="btn btn-secondary" id="calendar-next-month">►</button>
                </div>
            </div>
            <div class="calendar-grid-header">
                <div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div><div>Sun</div>
            </div>
            <div class="calendar-grid">
              <!-- Calendar days will be generated by JS -->
            </div>
          </div>
        </section>
        
        <!-- Holiday Request View -->
        <section id="holiday-request-view" class="hidden">
            <div class="card">
                <h2>Holiday & Leave Requests</h2>
                <div class="grid-2-col">
                    <div class="card card-nested">
                        <h3>Request New Leave</h3>
                        <form id="holiday-request-form" class="form-grid">
                            <div class="full-width"><label for="holiday-leave-type">Leave Type</label><select id="holiday-leave-type"><option value="holiday">Holiday</option><option value="unpaid">Unpaid Leave</option><option value="sick">Sick Leave</option></select></div>
                            <div><label for="holiday-start-date">Start Date</label><input type="date" id="holiday-start-date" required></div>
                            <div><label for="holiday-end-date">End Date</label><input type="date" id="holiday-end-date" required></div>
                            <div class="full-width"><label for="holiday-reason">Reason (Optional)</label><input type="text" id="holiday-reason" placeholder="e.g. Family vacation"></div>
                            <div class="full-width"><button type="submit" class="btn btn-primary">Submit Request</button></div>
                        </form>
                    </div>
                    <div class="card card-nested">
                        <h3>Your Requests</h3>
                        <ul id="user-holiday-request-list" class="simple-list"><li>No requests found.</li></ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Shift Swap View -->
        <section id="shift-swap-view" class="hidden">
            <div class="card">
                <h2>Request a Shift Swap</h2>
                <p class="subtitle">Select one of your upcoming shifts to offer it for a swap.</p>
                <div class="card card-nested">
                    <h3>Your Upcoming Shifts</h3>
                    <ul id="swap-shift-list" class="simple-list"><li>No upcoming shifts eligible for swap.</li></ul>
                </div>
            </div>
        </section>

        <!-- Dashboard View (Admin) -->
        <section id="dashboard-view" class="hidden"><div class="card"><h2>Admin Dashboard</h2><p>Analytics and high-level views for management.</p></div></section>
        
        <!-- My Settings View -->
        <section id="my-settings-view" class="hidden">
            <div class="card" style="max-width: 500px; margin: 0 auto;">
                <h2>My Settings</h2>
                <form id="change-pin-form">
                    <h3>Change Your PIN</h3>
                    <label for="current-pin">Current PIN</label>
                    <input type="password" id="current-pin" maxlength="4" required>
                    <label for="new-pin" style="margin-top: 1rem;">New PIN</label>
                    <input type="password" id="new-pin" maxlength="4" required>
                    <label for="confirm-new-pin" style="margin-top: 1rem;">Confirm New PIN</label>
                    <input type="password" id="confirm-new-pin" maxlength="4" required>
                    <button type="submit" class="btn btn-primary" style="margin-top: 2rem;">Update PIN</button>
                </form>
            </div>
        </section>

        <!-- Main Admin Panel -->
        <section id="admin-view" class="hidden">
          <div class="card">
            <h2>Admin Panel</h2>
            <div class="admin-tabs">
              <button class="admin-tab-btn active" data-tab="staff">Staff Management</button>
              <button class="admin-tab-btn" data-tab="rota">Rota & Shifts</button>
              <button class="admin-tab-btn" data-tab="wages">Wages</button>
              <button class="admin-tab-btn" data-tab="holidays">Holidays & Leave</button>
            </div>

            <div class="admin-tab-content">
                <!-- Staff Management Tab -->
                <div id="admin-tab-staff" class="active">
                    <div class="admin-grid">
                      <div class="card card-nested">
                          <h3>Create New Staff Member</h3>
                          <form id="admin-create-account-form" class="form-grid">
                              <div class="full-width"><label for="admin-new-account-name">Full Name</label><input type="text" id="admin-new-account-name" required></div>
                              <div><label for="admin-new-account-wage">Hourly Rate (£)</label><input type="number" id="admin-new-account-wage" required placeholder="e.g., 11.44" step="0.01"></div>
                              <div><label for="admin-new-account-gender">Gender</label><select id="admin-new-account-gender" required><option value="" disabled selected>-- Select --</option><option value="male">Male (👨)</option><option value="female">Female (👩)</option><option value="other">Other (👤)</option></select></div>
                              <div class="full-width"><label for="admin-new-account-role">Role</label><select id="admin-new-account-role" required><option value="" disabled selected>-- Select --</option><option value="FOH">FOH</option><option value="BOH">BOH</option><option value="Supervisor">Supervisor</option><option value="Manager">Manager</option><option value="Owner">Owner</option></select></div>
                              <div class="full-width"><button type="submit" class="btn btn-primary">Create Account</button></div>
                          </form>
                      </div>
                      <div class="card card-nested">
                        <h3>Existing Staff Accounts</h3>
                        <ul id="user-accounts-list" class="simple-list"><li class="no-data">Loading...</li></ul>
                      </div>
                    </div>
                </div>

                <!-- Rota & Shifts Tab -->
                <div id="admin-tab-rota" class="hidden">
                    <h3>Rota Management & Availability</h3>
                    <p class="subtitle">Assign shifts, view staff availability, and manage the full rota.</p>
                    <div class="card card-nested" id="admin-availability-viewer">
                        <h4>Weekly Availability Viewer</h4>
                        <!-- Availability viewer will be rendered by JS -->
                    </div>
                </div>

                <!-- Wages Tab -->
                <div id="admin-tab-wages" class="hidden">
                    <h3>Wages Report</h3>
                     <div class="card card-nested">
                        <h4>Weekly Wage Report</h4>
                        <p class="subtitle">Estimated wage costs based on rota hours for the current week.</p>
                        <table id="wage-report-table">
                            <thead><tr><th>Staff Member</th><th>Hours Worked</th><th>Hourly Rate</th><th>Estimated Pay</th></tr></thead>
                            <tbody><tr><td colspan="4">No rota data for this week.</td></tr></tbody>
                        </table>
                    </div>
                </div>
              
                <!-- Holidays Tab -->
                <div id="admin-tab-holidays" class="hidden">
                  <h3>Holidays & Leave Management</h3>
                   <div class="grid-2-col">
                       <div class="card card-nested">
                           <h4>Pending Requests</h4>
                           <ul id="admin-pending-holidays" class="simple-list"><li>No pending requests.</li></ul>
                       </div>
                       <div class="card card-nested">
                           <h4>Create Business-wide Holiday</h4>
                           <p class="subtitle">Add a closure day for all staff.</p>
                           <form id="admin-business-holiday-form" class="form-grid">
                               <div><label for="business-holiday-date">Date</label><input type="date" id="business-holiday-date" required></div>
                               <div class="full-width"><label for="business-holiday-reason">Reason</label><input type="text" id="business-holiday-reason" required placeholder="e.g. Christmas Day"></div>
                               <div><button type="submit" class="btn btn-primary">Add Closure Day</button></div>
                           </form>
                       </div>
                   </div>
                </div>

            </div>
          </div>
        </section>
    </main>
</div>

<div id="toast-container"></div>
<script src="app.js"></script>
</body>
</html>
